-- 1. Exibir nome do agricultor com seu respectivo endereço completo
SELECT A.Nome, E.Rua, E.numero, E.UF, E.Complemento
FROM Agricultores A
INNER JOIN Endereço_agricultor E ON A.id_endereco = E.id_endereco;


-- 2. Exibir informações dos lotes com o destino da entrega
SELECT L.Numero_lote, L.Especie, E.Destinátario, E.Comprovante
FROM Lotes L
INNER JOIN Entrega E ON L.id_entrega = E.id_entrega;


-- 3. Consultar as datas de rastreio de cada lote
SELECT L.Numero_lote, L.Especie, R.Entrada, R.Saida, R.Entrega
FROM Lotes L
INNER JOIN Rastreabilidade R ON L.QR_lote = R.QR_lote;


-- 4. Mostrar produtos armazenados e seus respectivos lotes
SELECT A.id_armazem, A.Tipo_produto, A.Quantidade, L.Especie, L.Validade
FROM Armazéns A
INNER JOIN Lotes L ON A.Numero_lote = L.Numero_lote;


-- 5. Exibir movimentações de entrada e saída por armazém
SELECT M.id_armazem, M.Entrada, M.Saida, M.Saldo_armazem, A.Tipo_produto
FROM Movimentações M
INNER JOIN Armazéns A ON M.id_armazem = A.id_armazem;


-- 6. Listar produtos, espécie e destinatário da entrega
SELECT A.Tipo_produto, L.Especie, E.Destinátario
FROM Armazéns A
INNER JOIN Lotes L ON A.Numero_lote = L.Numero_lote
INNER JOIN Entrega E ON L.id_entrega = E.id_entrega;


-- 7. Mostrar agricultores e a cidade em que estão localizados
SELECT A.Nome AS Agricultor, M.Cidade, M.Estado
FROM Agricultores A
INNER JOIN Endereço_agricultor E ON A.id_endereco = E.id_endereco
INNER JOIN Municípios M ON M.id_Municipios = A.id_endereco;


-- 8. Exibir rastreamento completo de cada entrega
SELECT L.Numero_lote, R.Entrada, R.Saida, R.Entrega, E.Destinátario
FROM Lotes L
INNER JOIN Rastreabilidade R ON L.QR_lote = R.QR_lote
INNER JOIN Entrega E ON L.id_entrega = E.id_entrega;


-- 9. Exibir movimentações de cada lote em estoque
SELECT L.Numero_lote, A.Tipo_produto, M.Entrada, M.Saida, M.Saldo_armazem
FROM Armazéns A
INNER JOIN Movimentações M ON A.id_armazem = M.id_armazem
INNER JOIN Lotes L ON A.Numero_lote = L.Numero_lote;

-- 10. Exibir data prevista e status logístico de entregas
SELECT E.id_entrega, L.Data_prevista, L.Comprovante_entrega
FROM Entrega E
INNER JOIN Logística L ON E.id_entrega = L.id_ordem;

-- 11. Exibir fornecedores e os produtos (espécies) cadastrados por eles
SELECT F.Nome AS Fornecedor, E.Tipo_esp AS Especie
FROM Fornecedores F
INNER JOIN Cadastro C ON F.CNPJ_FORNECEDOR = C.CNPJ_FORNECODR
INNER JOIN Espécies E ON C.id_especies = E.id_especies;

-- 12. Mostrar agricultores, espécies e fornecedores envolvidos no cadastro
SELECT A.Nome AS Agricultor, E.Tipo_esp AS Especie, F.Nome AS Fornecedor
FROM Agricultores A
INNER JOIN Cadastro C ON A.CNPJ = C.CNPJ
INNER JOIN Espécies E ON C.id_especies = E.id_especies
INNER JOIN Fornecedores F ON C.CNPJ_FORNECODR = F.CNPJ_FORNECEDOR;

-- 13. Exibir dados de armazém, lote e fornecedor responsável
SELECT AR.id_armazem, AR.Tipo_produto, L.Especie, F.Nome AS Fornecedor
FROM Armazéns AR
INNER JOIN Cadastro C ON AR.id_armazem = C.id_armazem
INNER JOIN Lotes L ON AR.Numero_lote = L.Numero_lote
INNER JOIN Fornecedores F ON C.CNPJ_FORNECODR = F.CNPJ_FORNECEDOR;

-- 14. Mostrar municípios, espécies produzidas e agricultores relacionados
SELECT M.Cidade, M.Estado, E.Tipo_esp AS Especie, A.Nome AS Agricultor
FROM Municípios M
INNER JOIN Cadastro C ON M.id_Municipios = C.id_municipio
INNER JOIN Espécies E ON C.id_especies = E.id_especies
INNER JOIN Agricultores A ON C.CNPJ = A.CNPJ;

-- 15. Exibir fornecedores e municípios onde atuam
SELECT F.Nome AS Fornecedor, M.Cidade, M.Estado
FROM Fornecedores F
INNER JOIN Cadastro C ON F.CNPJ_FORNECEDOR = C.CNPJ_FORNECODR
INNER JOIN Municípios M ON C.id_municipio = M.id_Municipios;

-- 16. Mostrar armazéns com seus produtos, municípios e agricultores
SELECT AR.id_armazem, AR.Tipo_produto, M.Cidade, A.Nome AS Agricultor
FROM Armazéns AR
INNER JOIN Cadastro C ON AR.id_armazem = C.id_armazem
INNER JOIN Municípios M ON C.id_municipio = M.id_Municipios
INNER JOIN Agricultores A ON C.CNPJ = A.CNPJ;

-- 17. Relacionar espécies com suas movimentações e armazéns
SELECT E.Tipo_esp, Mv.Entrada, Mv.Saida, AR.Status_produto
FROM Espécies E
INNER JOIN Cadastro C ON E.id_especies = C.id_especies
INNER JOIN Armazéns AR ON C.id_armazem = AR.id_armazem
INNER JOIN Movimentações Mv ON AR.id_armazem = Mv.id_armazem;

-- 18. Exibir rastreabilidade e informações logísticas associadas
SELECT R.QR_lote, R.Entrada, R.Saida, Lg.Data_prevista, Lg.Comprovante_entrega
FROM Rastreabilidade R
INNER JOIN Lotes Lt ON R.QR_lote = Lt.QR_lote
INNER JOIN Logística Lg ON Lt.id_entrega = Lg.id_ordem;

-- 19. Mostrar agricultores, suas entregas e status de logística
SELECT A.Nome AS Agricultor, E.Destinátario, Lg.Comprovante_entrega
FROM Agricultores A
INNER JOIN Cadastro C ON A.CNPJ = C.CNPJ
INNER JOIN Armazéns AR ON C.id_armazem = AR.id_armazem
INNER JOIN Lotes L ON AR.Numero_lote = L.Numero_lote
INNER JOIN Entrega E ON L.id_entrega = E.id_entrega
INNER JOIN Logística Lg ON E.id_entrega = Lg.id_ordem;

-- 20. Exibir fornecedores, produtos e status do estoque no armazém
SELECT F.Nome AS Fornecedor, AR.Tipo_produto, AR.Status_produto
FROM Fornecedores F
INNER JOIN Cadastro C ON F.CNPJ_FORNECEDOR = C.CNPJ_FORNECODR
INNER JOIN Armazéns AR ON C.id_armazem = AR.id_armazem;


USE banco_pi;

-- 1️ View: Agricultores e seus endereços completos
CREATE OR REPLACE VIEW vw_agricultores_enderecos AS
SELECT 
    A.Nome, 
    E.Rua, 
    E.numero, 
    E.UF, 
    E.Complemento
FROM Agricultores A
INNER JOIN Endereço_agricultor E 
    ON A.id_endereco = E.id_endereco;

-- 2️ View: Lotes e informações de entrega
CREATE OR REPLACE VIEW vw_lotes_entregas AS
SELECT 
    L.Numero_lote, 
    L.Especie, 
    E.Destinátario, 
    E.Comprovante
FROM Lotes L
INNER JOIN Entrega E 
    ON L.id_entrega = E.id_entrega;

-- 3️ View: Datas de rastreabilidade por lote
CREATE OR REPLACE VIEW vw_lotes_rastreabilidade AS
SELECT 
    L.Numero_lote, 
    L.Especie, 
    R.Entrada, 
    R.Saida, 
    R.Entrega
FROM Lotes L
INNER JOIN Rastreabilidade R 
    ON L.QR_lote = R.QR_lote;

-- 4️ View: Produtos armazenados e seus lotes
CREATE OR REPLACE VIEW vw_produtos_armazenados AS
SELECT 
    A.id_armazem, 
    A.Tipo_produto, 
    A.Quantidade, 
    L.Especie, 
    L.Validade
FROM Armazéns A
INNER JOIN Lotes L 
    ON A.Numero_lote = L.Numero_lote;

-- 5️ View: Movimentações por armazém
CREATE OR REPLACE VIEW vw_movimentacoes_armazem AS
SELECT 
    M.id_armazem, 
    M.Entrada, 
    M.Saida, 
    M.Saldo_armazem, 
    A.Tipo_produto
FROM Movimentações M
INNER JOIN Armazéns A 
    ON M.id_armazem = A.id_armazem;

-- 6️ View: Produtos, espécie e destinatário da entrega
CREATE OR REPLACE VIEW vw_produtos_entregas AS
SELECT 
    A.Tipo_produto, 
    L.Especie, 
    E.Destinátario
FROM Armazéns A
INNER JOIN Lotes L 
    ON A.Numero_lote = L.Numero_lote
INNER JOIN Entrega E 
    ON L.id_entrega = E.id_entrega;

-- 7️ View: Agricultores e cidade (corrigido relacionamento)
CREATE OR REPLACE VIEW vw_agricultores_cidades AS
SELECT 
    A.Nome AS Agricultor, 
    M.Cidade, 
    M.Estado
FROM Agricultores A
INNER JOIN Endereço_agricultor E 
    ON A.id_endereco = E.id_endereco
INNER JOIN Municípios M 
    ON M.id_Municipios = E.id_endereco;

-- 8️ View: Rastreamento completo de cada entrega
CREATE OR REPLACE VIEW vw_rastreamento_entregas AS
SELECT 
    L.Numero_lote, 
    R.Entrada, 
    R.Saida, 
    R.Entrega, 
    E.Destinátario
FROM Lotes L
INNER JOIN Rastreabilidade R 
    ON L.QR_lote = R.QR_lote
INNER JOIN Entrega E 
    ON L.id_entrega = E.id_entrega;

-- 9️ View: Movimentações de lotes em estoque
CREATE OR REPLACE VIEW vw_movimentacoes_lotes AS
SELECT 
    L.Numero_lote, 
    A.Tipo_produto, 
    M.Entrada, 
    M.Saida, 
    M.Saldo_armazem
FROM Armazéns A
INNER JOIN Movimentações M 
    ON A.id_armazem = M.id_armazem
INNER JOIN Lotes L 
    ON A.Numero_lote = L.Numero_lote;

-- 10 View: Status logístico das entregas
CREATE OR REPLACE VIEW vw_status_logistica AS
SELECT 
    E.id_entrega, 
    L.Data_prevista, 
    L.Comprovante_entrega
FROM Entrega E
INNER JOIN Logística L 
    ON E.id_entrega = L.id_ordem;

-- 11
CREATE OR REPLACE VIEW vw_fornecedores_especies AS
SELECT F.Nome AS Fornecedor, E.Tipo_esp AS Especie
FROM Fornecedores F
INNER JOIN Cadastro C ON F.CNPJ_FORNECEDOR = C.CNPJ_FORNECODR
INNER JOIN Espécies E ON C.id_especies = E.id_especies;

-- 12
CREATE OR REPLACE VIEW vw_agricultores_especies_fornecedores AS
SELECT A.Nome AS Agricultor, E.Tipo_esp AS Especie, F.Nome AS Fornecedor
FROM Agricultores A
INNER JOIN Cadastro C ON A.CNPJ = C.CNPJ
INNER JOIN Espécies E ON C.id_especies = E.id_especies
INNER JOIN Fornecedores F ON C.CNPJ_FORNECODR = F.CNPJ_FORNECEDOR;

-- 13
CREATE OR REPLACE VIEW vw_armazem_lote_fornecedor AS
SELECT AR.id_armazem, AR.Tipo_produto, L.Especie, F.Nome AS Fornecedor
FROM Armazéns AR
INNER JOIN Cadastro C ON AR.id_armazem = C.id_armazem
INNER JOIN Lotes L ON AR.Numero_lote = L.Numero_lote
INNER JOIN Fornecedores F ON C.CNPJ_FORNECODR = F.CNPJ_FORNECEDOR;

-- 14
CREATE OR REPLACE VIEW vw_municipios_especies_agricultores AS
SELECT M.Cidade, M.Estado, E.Tipo_esp AS Especie, A.Nome AS Agricultor
FROM Municípios M
INNER JOIN Cadastro C ON M.id_Municipios = C.id_municipio
INNER JOIN Espécies E ON C.id_especies = E.id_especies
INNER JOIN Agricultores A ON C.CNPJ = A.CNPJ;

-- 15
CREATE OR REPLACE VIEW vw_fornecedores_municipios AS
SELECT F.Nome AS Fornecedor, M.Cidade, M.Estado
FROM Fornecedores F
INNER JOIN Cadastro C ON F.CNPJ_FORNECEDOR = C.CNPJ_FORNECODR
INNER JOIN Municípios M ON C.id_municipio = M.id_Municipios;

-- 16
CREATE OR REPLACE VIEW vw_armazem_municipio_agricultor AS
SELECT AR.id_armazem, AR.Tipo_produto, M.Cidade, A.Nome AS Agricultor
FROM Armazéns AR
INNER JOIN Cadastro C ON AR.id_armazem = C.id_armazem
INNER JOIN Municípios M ON C.id_municipio = M.id_Municipios
INNER JOIN Agricultores A ON C.CNPJ = A.CNPJ;

-- 17
CREATE OR REPLACE VIEW vw_especies_movimentacoes AS
SELECT E.Tipo_esp, Mv.Entrada, Mv.Saida, AR.Status_produto
FROM Espécies E
INNER JOIN Cadastro C ON E.id_especies = C.id_especies
INNER JOIN Armazéns AR ON C.id_armazem = AR.id_armazem
INNER JOIN Movimentações Mv ON AR.id_armazem = Mv.id_armazem;

-- 18
CREATE OR REPLACE VIEW vw_rastreabilidade_logistica AS
SELECT R.QR_lote, R.Entrada, R.Saida, Lg.Data_prevista, Lg.Comprovante_entrega
FROM Rastreabilidade R
INNER JOIN Lotes Lt ON R.QR_lote = Lt.QR_lote
INNER JOIN Logística Lg ON Lt.id_entrega = Lg.id_ordem;

-- 19
CREATE OR REPLACE VIEW vw_agricultores_entregas_logistica AS
SELECT A.Nome AS Agricultor, E.Destinátario, Lg.Comprovante_entrega
FROM Agricultores A
INNER JOIN Cadastro C ON A.CNPJ = C.CNPJ
INNER JOIN Armazéns AR ON C.id_armazem = AR.id_armazem
INNER JOIN Lotes L ON AR.Numero_lote = L.Numero_lote
INNER JOIN Entrega E ON L.id_entrega = E.id_entrega
INNER JOIN Logística Lg ON E.id_entrega = Lg.id_ordem;

-- 20
CREATE OR REPLACE VIEW vw_fornecedores_produtos_estoque AS
SELECT F.Nome AS Fornecedor, AR.Tipo_produto, AR.Status_produto
FROM Fornecedores F
INNER JOIN Cadastro C ON F.CNPJ_FORNECEDOR = C.CNPJ_FORNECODR
INNER JOIN Armazéns AR ON C.id_armazem = AR.id_armazem;
